<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard Warga RT 002</title>

<style>
body {
  margin: 0;
  font-family: 'Segoe UI', sans-serif;
  background: #0f172a;
  color: white;
}

header {
  background: #111827;
  padding: 20px 40px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  box-shadow: 0 5px 20px rgba(0,0,0,0.4);
}

header h2 {
  margin: 0;
  font-weight: 500;
}

.logout-btn {
  background: #ef4444;
  border: none;
  padding: 10px 18px;
  border-radius: 8px;
  color: white;
  cursor: pointer;
  transition: 0.3s;
}

.logout-btn:hover {
  background: #dc2626;
}

.container {
  padding: 40px;
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 25px;
}

.card {
  background: #1e293b;
  padding: 25px;
  border-radius: 15px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.4);
  transition: 0.3s;
}

.card:hover {
  transform: translateY(-5px);
}

.card h3 {
  margin-top: 0;
  color: #38bdf8;
}

input {
  width: 100%;
  padding: 12px;
  border-radius: 8px;
  border: none;
  margin-top: 10px;
  background: #334155;
  color: white;
  outline: none;
}

button.save-btn {
  margin-top: 15px;
  background: #38bdf8;
  border: none;
  padding: 10px 18px;
  border-radius: 8px;
  cursor: pointer;
  color: #0f172a;
  font-weight: bold;
  transition: 0.3s;
}

button.save-btn:hover {
  background: #0ea5e9;
}

.info-box {
  font-size: 14px;
  opacity: 0.8;
}

.footer {
  text-align: center;
  padding: 20px;
  font-size: 13px;
  opacity: 0.6;
}
</style>
</head>

<body>

<header>
  <h2>üè† Dashboard Warga RT 002</h2>
  <button class="logout-btn" onclick="logout()">Logout</button>
</header>

<div class="container">

  <div class="card">
    <h3>üë§ Informasi Akun</h3>
    <p id="userEmail" class="info-box"></p>
  </div>

<div class="card">
  <h3>‚úèÔ∏è Edit Profil</h3>

  <input type="text" id="nama" placeholder="Nama Lengkap" required>
  <input type="text" id="nohp" placeholder="Nomor HP" required>

  <select id="jabatan" style="width:100%; padding:12px; margin-top:10px; border-radius:8px;">
    <option value="">-- Pilih Jabatan di RT 02 --</option>
    <option value="Ketua RT">Ketua RT</option>
    <option value="Sekretaris RT">Sekretaris RT</option>
    <option value="Bendahara">Bendahara</option>
    <option value="Warga">Warga</option>
    <option value="Lainnya">Lainnya</option>
  </select>

  <button class="save-btn" onclick="simpan()">Simpan Perubahan</button>
</div>

</div>

<div class="footer">
  ¬© 2026 RT 002 RW 002 Dusun Cijeruk
</div>

<script type="module">
import { initializeApp } from 
"https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getAuth, onAuthStateChanged, signOut } 
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
import { getFirestore, setDoc, doc } 
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
    apiKey: "AIzaSyA0ZRsLrvZHL0I9biBI5-Ana7vVToaW5Qo",
    authDomain: "data-rt-002-cijeruk.firebaseapp.com",
    projectId: "data-rt-002-cijeruk",
    storageBucket: "data-rt-002-cijeruk.firebasestorage.app",
    messagingSenderId: "942496035909",
    appId: "1:942496035909:web:7dfbb4adba70459859df2c",
    measurementId: "G-478RKMML3F"
  };

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

onAuthStateChanged(auth, (user) => {
  if (user) {
    document.getElementById("userEmail").innerText = "Email: " + user.email;
  } else {
    window.location.href = "login.html";
  }
});

window.simpan = async function() {
  const user = auth.currentUser;

  const nama = document.getElementById("nama").value;
  const nohp = document.getElementById("nohp").value;
  const jabatan = document.getElementById("jabatan").value;

  if (!nama || !nohp || !jabatan) {
    alert("Semua data wajib diisi!");
    return;
  }

  await setDoc(doc(db, "users", user.uid), {
    nama: nama,
    nohp: nohp,
    jabatan: jabatan,
    email: user.email,
    role: "warga"
  });

  alert("Data berhasil disimpan!");
}

window.logout = function() {
  signOut(auth)
    .then(() => {
      window.location.href = "login.html";
    })
    .catch((error) => {
      alert("Gagal logout: " + error.message);
    });
}
</script>

</body>
</html>
